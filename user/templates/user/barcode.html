{% extends "user/adminbase.html" %}
{% load static %}
{% block title %}
Add Products
{% endblock %}
{% block content %}

<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content">
        <div class="container-fluid">
            <br>
            {% if messages %}
<div class="container">
  {% for message in messages %}
  <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
    {{ message }}
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  {% endfor %}
</div>
{% endif %}


            <br>
            <div class="row">
                <div id="reader"></div>
                <div class="card card-primary ">
                    <div class="card-header text-center">
                        <h3 class="card-title ">Add Product</h3>
                    </div>
                    
                    <form id="scan-form" class="col-md-12 pb-3" enctype=multipart/form-data  method="POST">
                        {% csrf_token %}
                         <div class="row pr-2">
                            <div class="form-group  pl-2">
                                <label for="{{ form.shop_id.id_for_label }}">shop :</label>
                                <div class="input-group">
                                    {{ form.shop }}
                                </div>
                            </div>

                            <div class="form-group  pl-5">
                                <label for="{{ form.category.id_for_label }}">Category :</label>
                                <div class="input-group">
                                    {{ form.category}}
                                </div>
                            </div>



                        </div>
                        <div class="row pr-2">

                            <div class="form-group  pl-1">
                                <label for="{{ form.name.id_for_label }}">Product name:</label>
                                <div class="input-group ">
                                    {{ form.name }}
                                </div>
                            </div>

                            <div class="form-group pl-3 ">
                                <label for="{{ form.brand.id_for_label }}">Brand :</label>
                                <div class="input-group">
                                    {{ form.brand}}
                                </div>
                            </div>
                        </div>
                        <div class="row pr-2">
                            <div class="form-group pl-1">
                                <label for="{{ form.description.id_for_label }}">Product Description :</label>
                                <div class="input-group">
                                    {{ form.description}}
                                </div>
                            </div>

                            <div class="form-group pl-3">
                                <label for="{{ form.barcode.id_for_label }}">Product Barcode:</label>
                                <div class="input-group">
                                    <input type="text" class="form-group" id="barcode" name="barcode">

                                </div>
                            </div>
                        </div>

                        <div class="row pr-2">

                            <div class="form-group pl-1">
                                <label for="{{ form.price.id_for_label }}">Product Price:</label>
                                <div class="input-group">
                                    {{ form.price }}
                                </div>
                            </div>

                            <div class="form-group pl-2">
                                <label for="{{ form.picture.id_for_label }}">Product image:</label>
                                <div class="input-group">
                                    <div class="custom-file">
                                        {{form.picture}}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row col-md-12 pt-2">
                            <button type="submit" class="btn btn-info pl-2">Submit</button>
                           </div>
                    </form>
                </div>
            </div>

        </div>
        <script>
                        // This method will trigger user permissions
Html5Qrcode.getCameras().then(devices => {
  /**
   * devices would be an array of objects of type:
   * { id: "id", label: "label" }
   */
  if (devices && devices.length) {
    var cameraId = devices[0].id;
    // .. use this to start scanning.
  }
}).catch(err => {
  // handle err
});
function onScanSuccess(decodedText, decodedResult) {
  // handle the scanned code as you like, for example:
  console.log(`Code matched = ${decodedText}`, decodedResult);
  var barcodeInput = document.getElementById("barcode");
  // Update the barcode input field with the scanned value
        barcodeInput.value = decodedText;
        
}

function onScanFailure(error) {
  // handle scan failure, usually better to ignore and keep scanning.
  // for example:
  console.warn(`Code scan error = ${error}`);
}
// Initialize the scanner object

let html5QrcodeScanner = new Html5QrcodeScanner(
  "reader",
  { fps: 10, qrbox:  250 },
  /* verbose= */ false);
html5QrcodeScanner.render(onScanSuccess, onScanFailure);

        </script>

</div>
</section>


{% endblock %}